-- Load WindUI
local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

-- Ambil nama player
local player = game.Players.LocalPlayer
local playerName = player.Name
local playerDisplayName = player.DisplayName

-- Buat Window versi baru
local Window = WindUI:CreateWindow({
    Title = "Nexa - Premium",
    Icon = "rbxassetid://107488593993096",
    Author = "Fish IT! Script | @ Han",
    Folder = "Hanzo",
    Size = UDim2.fromOffset(540, 420),
    Transparent = true,
    Theme = "Dark",
    
    HidePanelBackground = true,
    NewElements = false,

    User = {
        Enabled = true,
        Anonymous = false,           -- false biar muncul nama asli
        Name = playerDisplayName,    -- Nama tampilan
        UserName = "@" .. playerName, -- Username Roblox
        Callback = function()
            WindUI:Notify({
                Title = "User Profile",
                Content = "User profile clicked!",
                Duration = 3
            })
        end
    },
    
    Acrylic = false,
    HideSearchBar = false,
    SideBarWidth = 200,
})

Window:Tag({
    Title = "v1.1.8",
    Color = Color3.fromHex("#30ff6a")
})


Window:EditOpenButton({
    Enabled = false
})

WindUI:Notify({
    Title = "Game Supported",
    Content = "Dig 🔴, 99 Nights in the Forest 🔴, Fish It 🟢, Grow A Garden 🔴",
    Icon = "gamepad",
    Duration = 6
})

task.delay(6.5, function()
    WindUI:Notify({
        Title = "Bug Report",
        Content = "If there are any errors, please let the developer know. Join Discord to report bugs.",
        Icon = "cloud-alert",
        Duration = 6
    })
end)

task.delay(13, function()
    WindUI:Notify({
        Title = "Purchase",
        Content = "If you want to buy this premium script key, join Discord to buy premium.",
        Icon = "shopping-cart",
        Duration = 6
    })
end)

-- ✅ Tab dan UI
local Tabs = {
    Home = Window:Tab({ Title = "Home", Icon = "house"  }),
    Active = Window:Tab({ Title = "Active", Icon = "info"  }),
    Player = Window:Tab({ Title = "Player", Icon = "user"  }),
    Farm = Window:Tab({ Title = "Farm", Icon = "fish"  }),
    Auto = Window:Tab({ Title = "Automaticaly", Icon = "repeat-2"  }),
    Shop = Window:Tab({ Title = "Shop", Icon = "shopping-cart"  }),
    Boat = Window:Tab({ Title = "Boat", Icon = "sailboat"  }),
    Teleport = Window:Tab({ Title = "Teleport", Icon = "map-pin"  }),
    Server = Window:Tab({ Title = "Server", Icon = "server"  }),
    Visual = Window:Tab({ Title = "Visual", Icon = "eye"  }),
}

Tabs.Home:Section({ Title = "Update" })

Tabs.Home:Divider()

Tabs.Home:Paragraph({
    Title = "Here's what's new:",
    Desc = [[
[/] Improve Auto Fish v2
    ]]
})

Tabs.Home:Section({ Title = "Server" })

Tabs.Home:Paragraph({
    Title = "Discord - Nexa | COMMUNITY",
    Desc = "Indonesia 🇮🇩",
    Image = "https://images-eds-ssl.xboxlive.com/image?url=4rt9.lXDC4H_93laV1_eHHFT949fUipzkiFOBH3fAiZZUCdYojwUyX2aTonS1aIwMrx6NUIsHfUHSLzjGJFxxsG72wAo9EWJR4yQWyJJaDaK1XdUso6cUMpI9hAdPUU_FNs11cY1X284vsHrnWtRw7oqRpN1m9YAg21d_aNKnIo-&format=source",
    ImageSize = 20,
    Color = "Grey",
    Buttons = {
        {
            Title = "Copy Link",
            Icon = "copy",
            Variant = "Tertiary",
            Callback = function()
                setclipboard("discord.gg/ECxQFc97F5")
                WindUI:Notify({
                    Title = "Copied!",
                    Content = "Discord link copied to clipboard",
                    Duration = 2
                })
            end
        }
    }
})

Tabs.Active:Section({ Title = "Status" })

Tabs.Active:Divider()
-- FPS, Ping, dan Lama di Server ke WindUI Paragraph

local RunService = game:GetService("RunService")
local Stats = game:GetService("Stats")

local displayFPS = 0
local accTime, accFrames = 0, 0
local smoothing = 0.15

-- Catat waktu join server
local joinTime = tick()

-- Buat Paragraph di tab Active
local statusParagraph = Tabs.Active:Paragraph({
    Title = "Status Player",
    Desc = "FPS: ...\nPing: ...\nTime: ..."
})

-- Fungsi format waktu (hh:mm:ss)
local function formatTime(seconds)
    local h = math.floor(seconds / 3600)
    local m = math.floor((seconds % 3600) / 60)
    local s = math.floor(seconds % 60)
    return string.format("%02d:%02d:%02d", h, m, s)
end

-- Update tiap frame
RunService.RenderStepped:Connect(function(dt)
    accTime = accTime + dt
    accFrames = accFrames + 1

    if accTime >= 0.5 then
        local instantFPS = accFrames / accTime
        displayFPS = displayFPS + (instantFPS - displayFPS) * smoothing

        -- Ambil ping (ms)
        local ping = Stats.Network.ServerStatsItem["Data Ping"]:GetValue()

        -- Lama waktu di server
        local elapsed = tick() - joinTime
        local timePlayed = formatTime(elapsed)

        -- Update Paragraph WindUI
        statusParagraph:SetDesc(
            "FPS: " .. math.floor(displayFPS + 0.5) ..
            "\nPing: " .. math.floor(ping) .. " ms" ..
            "\nTime: " .. timePlayed
        )

        accTime = 0
        accFrames = 0
    end
end)

Tabs.Active:Section({ Title = "Event" })

local success, player = pcall(function() return game.Players.LocalPlayer end)
if not success or not player then return end

local runService = game:GetService("RunService")

-- =========================
-- 🔹 Boss Status Paragraph
-- =========================
local BossStatusParagraph = Tabs.Active:Paragraph({
    Title = "Boss Status",
    Desc = "Checking...",
})

local function getBossParts()
    local results = {}
    pcall(function()
        for _, props in ipairs(workspace:GetChildren()) do
            if props.Name == "Props" then
                for _, obj in ipairs(props:GetChildren()) do
                    if obj.Name == "Ghost" and obj:FindFirstChild("Part") then
                        results["Ghost Shark Hunt"] = obj.Part
                    elseif obj.Name == "Shark" and obj:FindFirstChild("Part") then
                        results["Shark Hunt"] = obj.Part
                    elseif obj.Name == "Model" and obj:FindFirstChild("Part") then
                        results["Worm Hunt"] = obj.Part
                    elseif obj.Name == "Fishing" and obj:FindFirstChild("Part") then
                        results["Fishing Hunt"] = obj.Part
                    elseif obj.Name == "Megalodon" and obj:FindFirstChild("Color") then
                        results["Megalodon Hunt"] = obj.Color
                    end
                end
            end
        end
    end)
    return results
end

local function updateBossStatus()
    local parts = getBossParts()
    local list = {}

    local bossList = {
        "Ghost Shark Hunt",
        "Shark Hunt",
        "Worm Hunt",
        "Fishing Hunt",
        "Megalodon Hunt"
    }

    for _, name in ipairs(bossList) do
        if parts[name] then
            table.insert(list, name .. ": ✅ Spawned")
        else
            table.insert(list, name .. ": ❌ Not Found")
        end
    end

    pcall(function()
        BossStatusParagraph:SetDesc(table.concat(list, "\n"))
    end)
end

task.spawn(function()
    while true do
        task.wait(1)
        pcall(updateBossStatus)
    end
end)

-- =========================
-- 🔹 Auto Teleport Feature
-- =========================
local savedCFrame
local targetCFrame
local connection
local respawnConnection
local selectedTargets = {}
local autoTeleportEnabled = false
local bodyVelocity
local monitorConnection

local targetOffsets = {
    ["Ghost Shark Hunt"] = Vector3.new(0, 5, 0),
    ["Shark Hunt"] = Vector3.new(0, 5, 0),
    ["Worm Hunt"] = Vector3.new(0, 30, 0),
    ["Fishing Hunt"] = Vector3.new(0, 5, 0),
    ["Megalodon Hunt"] = Vector3.new(0, 6, 0),
}

local function applyFreeze(hrp)
    if hrp and not bodyVelocity then
        pcall(function()
            bodyVelocity = Instance.new("BodyVelocity")
            bodyVelocity.Velocity = Vector3.new(0,0,0)
            bodyVelocity.MaxForce = Vector3.new(1e6,1e6,1e6)
            bodyVelocity.P = 9e9
            bodyVelocity.Parent = hrp
        end)
    end
end

local function removeFreeze()
    if bodyVelocity then
        pcall(function()
            bodyVelocity:Destroy()
            bodyVelocity = nil
        end)
    end
end

local function startMonitor(hrp)
    if monitorConnection then monitorConnection:Disconnect() end
    monitorConnection = runService.Heartbeat:Connect(function()
        if autoTeleportEnabled and targetCFrame and hrp then
            local distance = (hrp.Position - targetCFrame.Position).Magnitude
            if distance > 5 then
                pcall(function()
                    hrp.CFrame = targetCFrame
                end)
            end
        end
    end)
end

local function stopMonitor()
    if monitorConnection then
        monitorConnection:Disconnect()
        monitorConnection = nil
    end
end

local function getFirstAvailableTarget()
    local parts = getBossParts()
    for _, name in ipairs(selectedTargets) do
        if parts[name] then
            return name, parts[name]
        end
    end
    return nil, nil
end

local function teleportToTarget(char)
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    local chosenName, targetPart = getFirstAvailableTarget()
    if targetPart and chosenName then
        if not savedCFrame then
            savedCFrame = hrp.CFrame
        end

        local offset = targetOffsets[chosenName] or Vector3.new(0,5,0)
        targetCFrame = targetPart.CFrame + offset

        pcall(function()
            hrp.CFrame = targetCFrame
        end)
        task.wait(0.1)
        applyFreeze(hrp)
        startMonitor(hrp)

        if connection then connection:Disconnect() end
        connection = targetPart.AncestryChanged:Connect(function(_, parent)
            if not parent then
                removeFreeze()
                stopMonitor()
                if savedCFrame then
                    pcall(function()
                        hrp.CFrame = savedCFrame
                    end)
                end
                if connection then
                    connection:Disconnect()
                    connection = nil
                end
                if autoTeleportEnabled then
                    task.delay(0.5, function()
                        teleportToTarget(player.Character or player.CharacterAdded:Wait())
                    end)
                end
            end
        end)
    end
end

-- UI Controls
Tabs.Active:Dropdown({
    Title = "Choose Event",
    Values = { "Ghost Shark Hunt", "Shark Hunt", "Worm Hunt", "Fishing Hunt", "Megalodon Hunt" },
    Value = { "Ghost Shark Hunt" },
    Multi = true,
    AllowNone = true,
    Callback = function(options)
        selectedTargets = options
        if autoTeleportEnabled then
            local char = player.Character or player.CharacterAdded:Wait()
            teleportToTarget(char)
        end
    end
})

Tabs.Active:Toggle({
    Title = "Teleport To Event",
    Value = false,
    Callback = function(state)
        autoTeleportEnabled = state
        local char = player.Character or player.CharacterAdded:Wait()
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        if state then
            teleportToTarget(char)
            if respawnConnection then respawnConnection:Disconnect() end
            respawnConnection = player.CharacterAdded:Connect(function(newChar)
                teleportToTarget(newChar)
            end)
        else
            removeFreeze()
            stopMonitor()
            if savedCFrame then
                pcall(function()
                    hrp.CFrame = savedCFrame
                end)
            end

            if connection then
                connection:Disconnect()
                connection = nil
            end
            if respawnConnection then
                respawnConnection:Disconnect()
                respawnConnection = nil
            end

            savedCFrame = nil
            targetCFrame = nil
        end
    end
})

Tabs.Player:Section({ Title = "Settings" })

Tabs.Player:Toggle({
    Title = "Infinite Jump",
    Value = false,
    Callback = function(state)
        local Players = game:GetService("Players")
        local UserInputService = game:GetService("UserInputService")
        local player = Players.LocalPlayer

        if state then
            -- Aktifkan Infinite Jump
            _G.InfiniteJumpEnabled = true
            UserInputService.JumpRequest:Connect(function()
                if _G.InfiniteJumpEnabled then
                    local humanoid = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
                    if humanoid then
                        humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                        humanoid.Jump = true
                    end
                end
            end)
        else
            -- Nonaktifkan Infinite Jump
            _G.InfiniteJumpEnabled = false
        end
    end
})

Tabs.Player:Toggle({
    Title = "Bypass Oxygen Tank",
    Desc = "This toggle will equip an oxygen tank even though you don't have an oxygen tank. This is free. No coins needed",
    Default = false,
    Callback = function(state)
        local RepStorage = game:GetService("ReplicatedStorage")
        local Net = RepStorage:WaitForChild("Packages")
                        :WaitForChild("_Index")
                        :WaitForChild("sleitnick_net@0.2.0")
                        :WaitForChild("net")
        
        if state then
            -- Equip
            local args = {105} -- ID tank
            Net:WaitForChild("RF/EquipOxygenTank"):InvokeServer(unpack(args))
        else
            -- Unequip
            Net:WaitForChild("RF/UnequipOxygenTank"):InvokeServer()
        end
    end
})

Tabs.Player:Toggle({
    Title = "Bypass Radar",
    Value = false,
    Callback = function(state)
        -- Update nilai di Window
        Window.AlwayShowTab = state

        -- Panggil RemoteFunction untuk UpdateFishingRadar
        local args = { state }  -- true jika toggle ON, false jika OFF
        local remoteFunc = game:GetService("ReplicatedStorage")
            :WaitForChild("Packages")
            :WaitForChild("_Index")
            :WaitForChild("sleitnick_net@0.2.0")
            :WaitForChild("net")
            :WaitForChild("RF/UpdateFishingRadar")
        remoteFunc:InvokeServer(unpack(args))
    end
})

Tabs.Player:Slider({
    Title = "WalkSpeed Value",
    Step = 1,
    Value = {
        Min = 16,
        Max = 100,
        Default = 50,
    },
    Callback = function(value)
        _G.CustomWalkSpeedValue = value
        if _G.CustomWalkSpeedEnabled then
            local player = game:GetService("Players").LocalPlayer
            local humanoid = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = value
            end
        end
    end
})

-- Toggle WalkSpeed
Tabs.Player:Toggle({
    Title = "WalkSpeed",
    Value = false,
    Callback = function(state)
        local Players = game:GetService("Players")
        local player = Players.LocalPlayer
        local character = player.Character or player.CharacterAdded:Wait()
        local humanoid = character:WaitForChild("Humanoid")

        _G.CustomWalkSpeedEnabled = state

        if state then
            humanoid.WalkSpeed = _G.CustomWalkSpeedValue or 50
        else
            humanoid.WalkSpeed = 16 -- default Roblox
        end

        -- Agar tetap update saat respawn
        player.CharacterAdded:Connect(function(char)
            humanoid = char:WaitForChild("Humanoid")
            if _G.CustomWalkSpeedEnabled then
                humanoid.WalkSpeed = _G.CustomWalkSpeedValue or 50
            else
                humanoid.WalkSpeed = 16
            end
        end)
    end
})

Tabs.Player:Toggle({
    Title = "Noclip",
    Value = false,
    Callback = function(state)
        local Players = game:GetService("Players")
        local RunService = game:GetService("RunService")
        local player = Players.LocalPlayer

        _G.NoclipEnabled = state

        -- Fungsi untuk Noclip
        local function NoclipLoop(char)
            while _G.NoclipEnabled and char.Parent do
                for _, part in pairs(char:GetDescendants()) do
                    if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                        part.CanCollide = false
                    end
                end
                RunService.Stepped:Wait()
            end
        end

        if state then
            local character = player.Character
            if character then
                spawn(function() NoclipLoop(character) end)
            end
        else
            -- Kembalikan CanCollide ke true saat toggle mati
            local character = player.Character
            if character then
                for _, part in pairs(character:GetDescendants()) do
                    if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                        part.CanCollide = true
                    end
                end
            end
        end

        -- Pastikan Noclip tetap aktif saat respawn
        player.CharacterAdded:Connect(function(char)
            if _G.NoclipEnabled then
                spawn(function() NoclipLoop(char) end)
            end
        end)
    end
})

Tabs.Player:Section({ Title = "Codes" })

local allCodes = {
    "SHARKSSS",
    "100M",
    "MUTATE"
}

Tabs.Player:Button({
    Title = "Redeem All Codes",
    Callback = function()
        for _, code in ipairs(allCodes) do
            local args = { code }
            pcall(function()
                game:GetService("ReplicatedStorage")
                    :WaitForChild("Packages")
                    :WaitForChild("_Index")
                    :WaitForChild("sleitnick_net@0.2.0")
                    :WaitForChild("net")
                    :WaitForChild("RF/RedeemCode")
                    :InvokeServer(unpack(args))
            end)
        end
    end
})

Tabs.Farm:Section({ Title = "Info Fish!!" })

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- UI Notif
local smallNotif = playerGui:WaitForChild("Small Notification")
local display = smallNotif:WaitForChild("Display")
local container = display:WaitForChild("Container")

local notifications = playerGui:WaitForChild("Text Notifications")
local frame = notifications:WaitForChild("Frame")

-- posisi default (before) dan sukses
local beforePos = UDim2.new(0.5, 0, -1.89999998, 0)
local successPos = UDim2.new(0.5, 0, 0.100000001, 0)

-- counter sukses & gagal
local successCount = 0
local failCount = 0

-- satu paragraph gabungan
local ProgressParagraph = Tabs.Farm:Paragraph({
    Title = "Fishing Attempts",
    Desc = "Success: 0\nFailed: 0"
})

-- update text paragraph
local function updateParagraph()
    ProgressParagraph:SetDesc("Success: " .. successCount .. "\nFailed: " .. failCount)
end

-- === SUCCESS DETECTION (berdasarkan posisi container) ===
container:GetPropertyChangedSignal("Position"):Connect(function()
    local pos = container.Position

    if pos == successPos then
        successCount += 1
        updateParagraph()
    end
end)

-- === FAIL DETECTION (berdasarkan notifikasi text) ===
frame.ChildAdded:Connect(function(child)
    if child.Name == "TextTile" then
        local header = child:WaitForChild("Header", 5)
        if header and header:IsA("TextLabel") then
            if header.Text == "The fish got away!" then
                failCount += 1
                updateParagraph()
            end

            -- listen kalau text berubah setelah spawn
            header:GetPropertyChangedSignal("Text"):Connect(function()
                if header.Text == "The fish got away!" then
                    failCount += 1
                    updateParagraph()
                end
            end)
        end
    end
end)

Tabs.Farm:Section({ Title = "Fishing" })

-- Services
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local fishingGui = playerGui:WaitForChild("Fishing")
local mainFrame = fishingGui:WaitForChild("Main")
local vim = game:GetService("VirtualInputManager")
local camera = workspace.CurrentCamera

-- Default settings
local beforePosition = UDim2.new(0.5, 0, 1.5, 0)  -- posisi awal Main
local delayTime = 0.1  -- default delay klik (detik)
local toggleState = false  -- status toggle dari UI

-- Mapping dropdown ke delay
local delayMapping = {
    Slow = 0.8,
    Normal = 0.1,
    Fast = 0.05,
    ["Super Fast"] = 0.005,
    ["God Speed"] = 0.0001 
}

-- ==========================
-- WindUI Dropdown: Atur Delay Klik
-- ==========================
Tabs.Farm:Dropdown({
    Title = "Click Speed",
    Values = {"Slow", "Normal", "Fast", "Super Fast", "God Speed"},
    Value = "Slow", -- default
    Callback = function(option)
        delayTime = delayMapping[option] or 0.1
    end
})

-- ==========================
-- WindUI Toggle: Auto Fishing
-- ==========================
Tabs.Farm:Toggle({ 
    Title = "Auto Fish v1",
    Desc = "You must be at least level 3",
    Value = false,
    Callback = function(state)
        -- Simpan status toggle
        toggleState = state

        -- Kirim status Auto Fishing ke server
        local args = { state }
        game:GetService("ReplicatedStorage")
            :WaitForChild("Packages")
            :WaitForChild("_Index")
            :WaitForChild("sleitnick_net@0.2.0")
            :WaitForChild("net")
            :WaitForChild("RF/UpdateAutoFishingState")
            :InvokeServer(unpack(args))
    end
})

-- ==========================
-- Loop cek posisi Main & Auto Click ke UDim2 target
-- ==========================
task.spawn(function()
    while true do
        task.wait(delayTime)

        -- Hanya jalan kalau toggle aktif DAN posisi Main berubah
        if toggleState and mainFrame.Position ~= beforePosition then
            local screenSize = camera.ViewportSize
            local target = UDim2.new(0.88, 0, 0.89, -20)

            -- konversi ke pixel
            local targetX = (screenSize.X * target.X.Scale) + target.X.Offset
            local targetY = (screenSize.Y * target.Y.Scale) + target.Y.Offset

            -- klik
            vim:SendMouseButtonEvent(targetX, targetY, 0, true, game, 0)  -- down
            vim:SendMouseButtonEvent(targetX, targetY, 0, false, game, 0) -- up
        end
    end
end)

-- Auto Fish v3 dengan Step4 (reset rod tiap cycle, tanpa warn spam)
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Net = ReplicatedStorage:WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")

local player = game.Players.LocalPlayer
local container = player:WaitForChild("PlayerGui")
    :WaitForChild("Small Notification")
    :WaitForChild("Display")
    :WaitForChild("Container")

-- Posisi awal container
local initialPos = UDim2.new(0.5, 0, -1.9, 0)

-- Toggle & Mode
local AutoFish = false
local FishMode = "PERFECT"

-- Step 1 → Charge Fishing Rod
local function Step1()
    Net:WaitForChild("RF/ChargeFishingRod"):InvokeServer(os.clock())
end

-- Step 2 → Start Fishing Minigame
local function Step2()
    local args
    if FishMode == "PERFECT" then
        args = { -0.75, 0.9949902531063812 }
    elseif FishMode == "OK" then
        args = { -0.75, 0.3251698002015836 }
    elseif FishMode == "AMAZING" then
        args = { -0.5718746185302734, 0.8702929274284 }
    elseif FishMode == "GREAT" then
        args = { -0.5718746185302734, 0.744264094698844 }
    else
        args = { -0.75, 0.9949902531063812 }
    end
    Net:WaitForChild("RF/RequestFishingMinigameStarted"):InvokeServer(unpack(args))
end

-- Helper: Fast reset rod
local function FastResetRod()
    Net:WaitForChild("RE/UnequipToolFromHotbar"):FireServer()
    task.wait(0.03)
    Net:WaitForChild("RE/EquipToolFromHotbar"):FireServer(1)
    task.wait(0.03)
end

-- Step 3 → Tunggu container berubah atau timeout 10 detik
local function Step3(callback)
    local connection

    connection = container:GetPropertyChangedSignal("Position"):Connect(function()
        local currentPos = container.Position
        if currentPos ~= initialPos then
            if connection and connection.Connected then
                connection:Disconnect()
            end
            callback() -- lanjut Step4
        end
    end)

    -- Timeout 10 detik
    task.delay(10, function()
        if connection and connection.Connected then
            connection:Disconnect()
            -- langsung ke Step4 (fast reset)
            Step4()
        end
    end)
end

-- Step 4 → Reset rod cepat lalu ulang Step1
function Step4()
    FastResetRod()
    if AutoFish then
        task.wait(0.001)
        RunCycle()
    end
end

-- Jalankan siklus Auto Fish
function RunCycle()
    task.spawn(function()
        while AutoFish do
            Step1()
            task.wait(0.18)
            Step2()
            Step3(function()
                -- Step3 selesai → Step4
                Step4()
            end)
            break
        end
    end)
end

-- WindUI Dropdown
Tabs.Farm:Dropdown({ 
    Title = "Choose Charge Mode", 
    Values = { "PERFECT", "OK", "AMAZING", "GREAT"}, 
    Value = "PERFECT", 
    Callback = function(option) 
        FishMode = option
    end
})

-- WindUI Toggle
Tabs.Farm:Toggle({
    Title = "Auto Fish v2",
    Desc = "Auto fish with Step4 rod reset",
    Value = false,
    Callback = function(state)
        AutoFish = state
        if state then
            RunCycle()
        end
    end
})

Tabs.Farm:Toggle({ 
    Title = "Auto Complete Fishing",
    Value = false,
    Callback = function(state)
        AutoCompleteFish = state
        if state then
            task.spawn(function()
                while AutoCompleteFish do
                    Net:WaitForChild("RE/FishingCompleted"):FireServer()
                    task.wait(0.01)
                end
            end)
        end
    end
})

Tabs.Farm:Toggle({ 
    Title = "Auto Equip Rod",
    Desc = "Automatically equips your fishing rod in slot 1 and unequips it when turned off",
    Value = false,
    Callback = function(state)
        if state then
            -- Equip Rod di slot 1
            Net:WaitForChild("RE/EquipToolFromHotbar"):FireServer(1)
        else
            -- Unequip saat toggle mati
            Net:WaitForChild("RE/UnequipToolFromHotbar"):FireServer()
        end
    end
})


Tabs.Farm:Section({ Title = "Best Farm" })

-- Daftar lokasi teleport Farm
local locations = {
    ["Stone"] = CFrame.new(-2083.80884, 9.69523144, 3664.54346, -0.803171635, 5.9872491e-08, -0.595747709, 9.3994899e-08, 1, -2.62217448e-08, 0.595747709, -7.70578055e-08, -0.803171635),
    ["Coin"]  = CFrame.new(-645.36969, 45.7505226, 171.437454, -0.918708026, -1.96595673e-09, 0.394937396, -3.33787185e-08, 1, -7.26680796e-08, -0.394937396, -7.99432485e-08, -0.918708026),
    ["Coin2"] = CFrame.new(1004.17523, 11.5092144, 5015.11865, -0.964095712, 2.82167214e-08, -0.265554935, -4.54795757e-09, 1, 1.2276702e-07, 0.265554935, 1.19566891e-07, -0.964095712),
    ["Exp"]   = CFrame.new(-2165.05469, 7.76960087, 3639.87451, -0.589090407, -9.40972313e-08, -0.808067143, -7.97141695e-08, 1, -5.83347344e-08, 0.808067143, 3.00499643e-08, -0.589090407),
    ["Ocean"] = CFrame.new(-2458.021, 11.5490398, 96.0804367, 0.0369801782, 0.421751857, -0.905956864, -4.17893498e-09, 0.906576991, 0.422040522, 0.999315977, -0.0156071307, 0.0335253812)
}

local selectedLocation = "Stone"

-- Toggle Teleport (sekalian freeze)
local tpToggle = false
local freezePos = nil
local bv, bg

-- Dropdown Select Farm
Tabs.Farm:Dropdown({
    Title = "Select Farm",
    Values = {"Stone", "Coin", "Exp", "Coin2", "Ocean"},
    Default = selectedLocation,
    Callback = function(value)
        selectedLocation = value

        -- Kalau toggle masih aktif, langsung teleport ke lokasi baru
        if tpToggle then
            local player = game.Players.LocalPlayer
            local char = player.Character or player.CharacterAdded:Wait()
            local hrp = char:WaitForChild("HumanoidRootPart")

            local target = locations[selectedLocation]
            if target then
                char:PivotTo(target)
                freezePos = hrp.Position -- update freezePos juga
            end
        end
    end
})

Tabs.Farm:Toggle({
    Title = "Teleport Now",
    Default = false,
    Callback = function(state)
        local player = game.Players.LocalPlayer
        local char = player.Character or player.CharacterAdded:Wait()
        local hrp = char:WaitForChild("HumanoidRootPart")

        tpToggle = state

        if state then
            -- Teleport ke lokasi
            local target = locations[selectedLocation]
            if target then
                char:PivotTo(target)
            end

            -- Simpan posisi freeze
            freezePos = hrp.Position

            -- BodyVelocity (supaya nggak jatuh)
            bv = Instance.new("BodyVelocity")
            bv.Velocity = Vector3.new(0, 0, 0)
            bv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
            bv.Parent = hrp

            -- BodyGyro (supaya orientasi stabil)
            bg = Instance.new("BodyGyro")
            bg.CFrame = hrp.CFrame
            bg.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
            bg.P = 1e5
            bg.Parent = hrp

            -- Anti-geser loop
            task.spawn(function()
                while tpToggle and hrp and hrp.Parent do
                    local dist = (hrp.Position - freezePos).Magnitude
                    if dist > 2 then
                        hrp.CFrame = CFrame.new(freezePos) -- kembalikan ke posisi awal
                    end
                    task.wait(0.2)
                end
            end)

        else
            -- Matikan freeze
            if bv then bv:Destroy() bv = nil end
            if bg then bg:Destroy() bg = nil end
            freezePos = nil
        end
    end
})

-- VARIABEL UTAMA
local savedPos = nil
local savedOrientation = nil
local teleportOn = false
local player = game.Players.LocalPlayer
local bodyVelocity -- untuk freeze
local bodyGyro -- untuk arah
local runService = game:GetService("RunService")
local monitorConnection -- loop untuk cek posisi

-- FUNGSI FREEZE & GYRO
local function applyFreeze(hrp)
    if not bodyVelocity then
        bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.Velocity = Vector3.new(0,0,0)
        bodyVelocity.MaxForce = Vector3.new(1e6,1e6,1e6)
        bodyVelocity.P = 9e9
        bodyVelocity.Parent = hrp
    end

    if not bodyGyro then
        bodyGyro = Instance.new("BodyGyro")
        bodyGyro.MaxTorque = Vector3.new(1e6,1e6,1e6)
        bodyGyro.P = 9e4
        bodyGyro.D = 500
        bodyGyro.CFrame = savedOrientation or hrp.CFrame
        bodyGyro.Parent = hrp
    end
end

local function removeFreeze()
    if bodyVelocity then
        bodyVelocity:Destroy()
        bodyVelocity = nil
    end
    if bodyGyro then
        bodyGyro:Destroy()
        bodyGyro = nil
    end
end

-- MONITOR POSISI (biar balik kalau kesenggol)
local function startMonitor(hrp)
    if monitorConnection then monitorConnection:Disconnect() end
    monitorConnection = runService.Heartbeat:Connect(function()
        if teleportOn and savedPos and hrp then
            local distance = (hrp.Position - savedPos.Position).Magnitude
            if distance > 2 then -- kalau lebih dari 5 stud dari posisi save
                hrp.CFrame = savedPos
            end
        end
    end)
end

local function stopMonitor()
    if monitorConnection then
        monitorConnection:Disconnect()
        monitorConnection = nil
    end
end

-- BUTTON SAVE POSISI
Tabs.Farm:Button({ 
    Title = "Save Lock Position", 
    Callback = function() 
        local char = player.Character or player.CharacterAdded:Wait()
        local hrp = char:WaitForChild("HumanoidRootPart")
        savedPos = hrp.CFrame
        savedOrientation = hrp.CFrame

        WindUI:Notify({
            Title = "Position Saved",
            Content = "Saved CFrame: " .. tostring(savedPos),
            Duration = 1,
        })
    end
})

-- TOGGLE TELEPORT & FREEZE
Tabs.Farm:Toggle({ 
    Title = "Teleport To Lock Position", 
    Value = false,
    Callback = function(state)
        teleportOn = state
        local char = player.Character
        if not char then return end
        local hrp = char:WaitForChild("HumanoidRootPart")

        if teleportOn and savedPos then
            -- Teleport ke posisi simpan
            hrp.CFrame = savedPos

            -- Freeze + Arah
            applyFreeze(hrp)

            -- Mulai monitor biar balik kalau kesenggol
            startMonitor(hrp)
        else
            -- Lepas freeze & stop monitor
            removeFreeze()
            stopMonitor()
        end
    end
})

-- HANDLE RESPAWN
player.CharacterAdded:Connect(function(char)
    local hrp = char:WaitForChild("HumanoidRootPart")
    if teleportOn and savedPos then
        task.wait(0.5)
        hrp.CFrame = savedPos
        applyFreeze(hrp)
        startMonitor(hrp)
    end
end)

Tabs.Farm:Section({ Title = "Sell" })

-- Default values
getgenv().SellDelay = 1
getgenv().AutoSell = false
getgenv().SellMode = "Delay" -- Default mode

-- Dropdown pilih mode Auto Sell
Tabs.Farm:Dropdown({ 
    Title = "Auto Sell Mode", 
    Values = { "Delay", "Backpack Full" },
    Value = "Delay", 
    Callback = function(option)
        getgenv().SellMode = option
    end
})

-- Slider Sell Delay (hanya dipakai kalau mode = Delay)
Tabs.Farm:Slider({
    Title = "Sell Delay",
    Default = 1,
    Min = 1,
    Max = 100,
    Rounding = 0,
    Callback = function(val)
        getgenv().SellDelay = val
    end
})

-- Toggle Auto Sell
Tabs.Farm:Toggle({
    Title = "Auto Sell Items",
    Default = false,
    Callback = function(state)
        getgenv().AutoSell = state

        if state then
            task.spawn(function()
                local remote = game:GetService("ReplicatedStorage")
                    :WaitForChild("Packages")
                    :WaitForChild("_Index")
                    :WaitForChild("sleitnick_net@0.2.0")
                    :WaitForChild("net")
                    :WaitForChild("RF/SellAllItems")

                local bagLabel = game:GetService("Players").LocalPlayer
                    .PlayerGui.Inventory.Main.Top.Options.Fish.Label.BagSize

                while getgenv().AutoSell do
                    pcall(function()
                        if getgenv().SellMode == "Delay" then
                            -- Mode Delay
                            remote:InvokeServer()
                            task.wait(getgenv().SellDelay)

                        elseif getgenv().SellMode == "Backpack Full" then
                            -- Mode Backpack Full (cek tiap 1 detik)
                            if bagLabel and bagLabel.Text ~= "" then
                                local current, max = string.match(bagLabel.Text, "([%d,]+)/([%d,]+)")
                                if current and max then
                                    current = tonumber((current:gsub(",", "")))
                                    max = tonumber((max:gsub(",", "")))
                                    if current >= max then
                                        remote:InvokeServer()
                                    end
                                end
                            end
                            task.wait(1)
                        end
                    end)
                end
            end)
        end
    end
})

Tabs.Auto:Section({ Title = "Info Quest" })

local board = workspace["!!! MENU RINGS"]["Deep Sea Tracker"].Board
local surfaceGui = board:WaitForChild("Gui")
local content = surfaceGui:WaitForChild("Content")

local labelNames = {"Label1", "Label2", "Label3", "Label4"}

-- Buat 1 paragraf kosong
local paragraph = Tabs.Auto:Paragraph({
    Title = "Deep Sea Quest",
    Desc = ""
})

-- Fungsi update isi paragraf
local function updateParagraph()
    local lines = {}

    for _, name in ipairs(labelNames) do
        local label = content:FindFirstChild(name)
        if label then
            table.insert(lines, label.Text)
        end
    end

    paragraph:SetDesc(table.concat(lines, "\n"))
end

-- Isi pertama kali
updateParagraph()

-- Update otomatis kalau ada perubahan
for _, name in ipairs(labelNames) do
    local label = content:FindFirstChild(name)
    if label then
        label:GetPropertyChangedSignal("Text"):Connect(updateParagraph)
    end
end

Tabs.Auto:Section({ Title = "Quest" })

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

-- Ambil Label1 dari Workspace
local questLabel = workspace["!!! MENU RINGS"]["Deep Sea Tracker"].Board.Gui.Content:WaitForChild("Label1")

-- Posisi teleport
local posBelum100 = CFrame.new(
    -3563.65063, -279.074219, -1605.75671,
     0.707868576,  1.15482976e-07,  0.706344128,
    -9.39126679e-08, 1,            -6.93785722e-08,
    -0.706344128,   -1.72237495e-08, 0.707868576
)

local posSudah100 = CFrame.new(
    -3698.01001, -135.073914, -1010.34033,
    -0.937130094, -7.4511493e-09,  0.348980278,
    -5.57951241e-09, 1,             6.36803633e-09,
    -0.348980278,  4.0207917e-09, -0.937130094
)

-- State toggle
local autoQuestEnabled = false
local freezeBV, freezeBG
local savedCFrame

-- Fungsi pasang freeze (BodyVelocity + BodyGyro)
local function Freeze(char)
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    -- Hapus dulu kalau sudah ada
    if freezeBV then freezeBV:Destroy() freezeBV = nil end
    if freezeBG then freezeBG:Destroy() freezeBG = nil end

    -- BodyVelocity
    freezeBV = Instance.new("BodyVelocity")
    freezeBV.Velocity = Vector3.new(0,0,0)
    freezeBV.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    freezeBV.Parent = hrp

    -- BodyGyro
    freezeBG = Instance.new("BodyGyro")
    freezeBG.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
    freezeBG.CFrame = hrp.CFrame
    freezeBG.Parent = hrp
end

-- Fungsi lepas freeze
local function Unfreeze()
    if freezeBV then freezeBV:Destroy() freezeBV = nil end
    if freezeBG then freezeBG:Destroy() freezeBG = nil end
end

-- Fungsi teleport
local function TeleportOnce(cf)
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        char:SetPrimaryPartCFrame(cf)
        savedCFrame = cf
        Freeze(char)
    end
end

-- Fungsi cek quest
local function CheckQuest()
    if not autoQuestEnabled then return end
    local text = questLabel.Text
    local persen = text:match("(%d+)%%")
    persen = tonumber(persen)

    if persen and persen < 100 then
        TeleportOnce(posBelum100)
    elseif persen and persen >= 100 then
        TeleportOnce(posSudah100)
    end
end

-- Jalankan saat teks berubah
questLabel:GetPropertyChangedSignal("Text"):Connect(CheckQuest)

-- Anti geser (balik ke posisi kalau lebih dari 2 stud)
RunService.Heartbeat:Connect(function()
    if autoQuestEnabled and savedCFrame then
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            local hrp = char.HumanoidRootPart
            if (hrp.Position - savedCFrame.Position).Magnitude > 2 then
                hrp.CFrame = savedCFrame
            end
        end
    end
end)

-- Toggle UI
Tabs.Auto:Toggle({
    Title = "Auto Deep Sea Quest",
    Desc = "When Toggle On you can't move because of Freeze",
    Value = false,
    Callback = function(state)
        autoQuestEnabled = state
        if state then
            CheckQuest()
        else
            Unfreeze()
            savedCFrame = nil
        end
    end
})

Tabs.Shop:Section({ Title = "Rod" })

-- Table mapping nama rod ke ID
local rodMap = {
	["Starter Rod"] = 1,
	["Luck Rod"] = 79,
	["Carbon Rod"] = 76,
	["Grass Rod"] = 85,
	["Demascus Rod"] = 77,
	["Ice Rod"] = 78,
	["Lucky Rod"] = 4,
	["Midnight Rod"] = 80,
	["Steampunk Rod"] = 6,
	["Chrome Rod"] = 7,
	["Astral Rod"] = 5,
}

local selectedRods = {}

-- Ambil semua nama rod dari rodMap sebagai Values dropdown
local rodNames = {}
for name, _ in pairs(rodMap) do
	table.insert(rodNames, name)
end

-- Dropdown multi-select dengan nama rod otomatis
Tabs.Shop:Dropdown({ 
    Title = "Select Rods",
    Values = rodNames,
    Default = {},
    Multi = true,
    Callback = function(values)
        selectedRods = {}
        for _, name in ipairs(values) do
            table.insert(selectedRods, rodMap[name])
        end
    end
})

-- Tombol beli rod yang dipilih
Tabs.Shop:Button({ 
    Title = "Purchase Rods",
    Callback = function()
        if #selectedRods == 0 then return end

        local remote = game:GetService("ReplicatedStorage")
            :WaitForChild("Packages")
            :WaitForChild("_Index")
            :WaitForChild("sleitnick_net@0.2.0")
            :WaitForChild("net")
            :WaitForChild("RF/PurchaseFishingRod")

        for _, id in ipairs(selectedRods) do
            pcall(function()
                remote:InvokeServer(id)
            end)
        end
    end
})

-- Tombol Buy Angler Rod
local anglerPrompt = workspace["!!! MENU RINGS"]["Ares Rod Stand"].Part.ShopPurchasePrompt.ProximityPrompt
Tabs.Shop:Button({
    Title = "Purchase Angler Rod",
    Callback = function()
        fireproximityprompt(anglerPrompt)
    end
})

-- Tombol Buy Ares Rod
local aresPrompt = workspace["!!! MENU RINGS"]["Ares Rod Stand"].Part.ShopPurchasePrompt.ProximityPrompt
Tabs.Shop:Button({
    Title = "Purchase Ares Rod",
    Callback = function()
        fireproximityprompt(aresPrompt)
    end
})

Tabs.Shop:Section({ Title = "Baits" })

-- Table mapping nama bait ke ID
local BaitID = {
    ["Topwater Bait"] = 10,
    ["Luck Bait"] = 2,
    ["Midnight Bait"] = 3,
    ["Nature Bait"] = 17,
    ["Chroma Bait"] = 6,
    ["Dark Matter Bait"] = 8,
    ["Corrupt Bait"] = 15,
    ["Aether Bait"] = 16,
}

local selectedBaits = {}

-- Ambil semua nama bait dari BaitID sebagai Values dropdown
local baitNames = {}
for name, _ in pairs(BaitID) do
    table.insert(baitNames, name)
end

-- Dropdown multi-select untuk memilih bait
Tabs.Shop:Dropdown({
    Title = "Select Baits",
    Values = baitNames,
    Default = {},
    Multi = true,
    Callback = function(values)
        selectedBaits = {}
        for _, name in ipairs(values) do
            table.insert(selectedBaits, BaitID[name])
        end
        print("Selected Bait IDs:", unpack(selectedBaits))
    end
})

-- Tombol beli bait yang dipilih
Tabs.Shop:Button({
    Title = "Purchase Selected Baits",
    Callback = function()
        if #selectedBaits == 0 then
            warn("No bait selected!")
            return
        end

        local remote = game:GetService("ReplicatedStorage")
            :WaitForChild("Packages")
            :WaitForChild("_Index")
            :WaitForChild("sleitnick_net@0.2.0")
            :WaitForChild("net")
            :WaitForChild("RF/PurchaseBait")

        for _, id in ipairs(selectedBaits) do
            print("Attempting to purchase bait ID:", id)
            local success, err = pcall(function()
                remote:InvokeServer(id)
            end)
            if success then
                print("Successfully purchased bait ID:", id)
            else
                warn("Failed to purchase bait ID", id, "Error:", err)
            end
        end
    end
})

Tabs.Shop:Section({ Title = "Items" })

-- Tombol Buy Diving Gear (menggunakan ProximityPrompt)
local divingPrompt = workspace["!!! MENU RINGS"]["Diving Gear Display"].Top.ShopPurchasePrompt.ProximityPrompt
Tabs.Shop:Button({
    Title = "Purchase Diving Gear",
    Callback = function()
        fireproximityprompt(divingPrompt)
    end
})

-- Tombol Buy Fishing Radar (menggunakan RemoteEvent)
Tabs.Shop:Button({
    Title = "Purchase Fishing Radar",
    Callback = function()
        local args = {81} -- ganti 81 sesuai ID gear
        local remote = game:GetService("ReplicatedStorage")
            :WaitForChild("Packages")
            :WaitForChild("_Index")
            :WaitForChild("sleitnick_net@0.2.0")
            :WaitForChild("net")
            :WaitForChild("RF/PurchaseGear")
        pcall(function()
            remote:InvokeServer(unpack(args))
        end)
    end
})

Tabs.Shop:Section({ Title = "Weather" })

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")

local PurchaseWeather = ReplicatedStorage
    :WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RF/PurchaseWeatherEvent")

-- simpan pilihan sementara (table untuk multi)
local selectedWeathers = {}

-- Dropdown buat pilih weather
Tabs.Shop:Dropdown({
    Title = "Select Weather",
    Values = { "Snow", "Wind", "Cloudy", "Storm", "Radiant", "Shark Hunt"},
    Value = { "Snow" }, -- default
    Multi = true,
    AllowNone = true,
    Callback = function(option)
        selectedWeathers = option -- ini table berisi semua pilihan
        if #selectedWeathers > 0 then
            WindUI:Notify({
                Title = "Weather Selected",
                Content = "You chose: " .. table.concat(selectedWeathers, ", "),
                Duration = 1,
            })
        else
            WindUI:Notify({
                Title = "Weather Cleared",
                Content = "No weather selected",
                Duration = 1,
            })
        end
    end
})

-- Button buat confirm purchase
Tabs.Shop:Button({
    Title = "Purchase Weather",
    Callback = function()
        if #selectedWeathers > 0 then
            for _, weather in ipairs(selectedWeathers) do
                local args = { weather }
                PurchaseWeather:InvokeServer(unpack(args))
                WindUI:Notify({
                    Title = "Purchase Success",
                    Content = "You bought weather: " .. weather,
                    Duration = 1,
                })
                task.wait(0.3) -- kasih jeda biar ga terlalu spam
            end
        else
            WindUI:Notify({
                Title = "Error",
                Content = "Please select at least one weather first!",
                Duration = 2,
            })
        end
    end
})

Tabs.Boat:Section({ Title = "Purchase" })

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local PurchaseBoat = ReplicatedStorage
    :WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RF/PurchaseBoat")

-- Daftar Boat (tinggal tambahin di sini kalau ada boat baru)
local BoatList = {
    ["Small Boat $300"] = 1,
    ["Kayak $1100"] = 2,
    ["Jetski $7500"] = 3,
    ["Highfield Boat $25000"] = 4,
    ["Speed Boat $70000"] = 5,
    ["Fishing Boat $180000"] = 6,
    ["Mini Yacht $1200000"] = 14,
    ["Mini Hoverboat $195 Robux"] = 15,
    ["Hyper Boat $999 Robux"] = 7,
}

-- Convert keys BoatList jadi table untuk dropdown
local BoatNames = {}
for name,_ in pairs(BoatList) do
    table.insert(BoatNames, name)
end
table.sort(BoatNames) -- biar rapi alfabet

-- Default pilihan
local selectedBoatID = BoatList[BoatNames[1]]

-- Dropdown Pilih Boat
Tabs.Boat:Dropdown({ 
    Title = "Select Boat",
    Values = BoatNames,
    Value = BoatNames[1],
    Multi = false,
    AllowNone = false,
    Callback = function(option) 
        selectedBoatID = BoatList[option]
        print("Selected Boat:", option, "ID:", selectedBoatID)
    end
})

-- Button Beli Boat
Tabs.Boat:Button({ 
    Title = "Purchase Boat",
    Callback = function() 
        local args = {selectedBoatID}
        local success, result = pcall(function()
            return PurchaseBoat:InvokeServer(unpack(args))
        end)

        if success then
            WindUI:Notify({
                Title = "Boat Purchased",
                Content = "You bought: " .. tostring(result),
                Duration = 2,
            })
        else
            WindUI:Notify({
                Title = "Purchase Failed",
                Content = tostring(result),
                Duration = 2,
            })
        end
    end
})

Tabs.Boat:Section({ Title = "Boat" })

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local SpawnBoat = ReplicatedStorage
    :WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RF/SpawnBoat")

-- Daftar Boat
local BoatList = {
    ["Small Boat"] = 1,
    ["Kayak"] = 2,
    ["Jetski"] = 3,
    ["Highfield Boat"] = 4,
    ["Speed Boat"] = 5,
    ["Fishing Boat"] = 6,
    ["Mini Yacht"] = 14,
    ["Mini Hoverboat"] = 15,
    ["Hyper Boat"] = 7,
    ["Dinky Fishing Boat"] = 20,
    ["Aura Boat"] = 17,
    ["Burger Boat"] = 18,
    ["Mega Hovercraft"] = 19,
    ["Froen Boat"] = 11,
    ["Cruiser Boat"] = 13,
    ["Rubber Ducky"] = 16,
}

-- Convert ke nama boat untuk dropdown
local BoatNames = {}
for name,_ in pairs(BoatList) do
    table.insert(BoatNames, name)
end
table.sort(BoatNames)

-- Default pilihan
local selectedBoatID = BoatList[BoatNames[1]]

-- Dropdown Pilih Boat
Tabs.Boat:Dropdown({ 
    Title = "Select Boat to Spawn",
    Values = BoatNames,
    Value = BoatNames[1],
    Multi = false,
    AllowNone = false,
    Callback = function(option) 
        selectedBoatID = BoatList[option]
        print("Selected Boat to Spawn:", option, "ID:", selectedBoatID)
    end
})

-- Button Spawn Boat
Tabs.Boat:Button({ 
    Title = "Spawn Boat",
    Callback = function() 
        local args = {selectedBoatID}
        local success, result = pcall(function()
            return SpawnBoat:InvokeServer(unpack(args))
        end)

        if success then
            WindUI:Notify({
                Title = "Boat Spawned",
                Content = "Spawned Boat: " .. tostring(result),
                Duration = 2,
            })
        else
            WindUI:Notify({
                Title = "Spawn Failed",
                Content = tostring(result),
                Duration = 2,
            })
        end
    end
})

Tabs.Teleport:Section({ Title = "Island" })

-- Daftar lokasi teleport (isi CFrame sesuai island)
local islands = {
    ["Kohana"] = CFrame.new(-642.243561, 16.0354481, 624.918884, 0.999580681, 0, -0.0289562326, 0, 1, 0, 0.0289562326, 0, 0.999580681),
    ["Winter Fest"] = CFrame.new(1687.93079, 6.8625145, 3309.67725, 0.96799022, -3.6394315e-08, -0.250987828, 1.06909646e-08, 1, -1.0377223e-07, 0.250987828, 9.77672059e-08, 0.96799022),
    ["Lost Isle"] = CFrame.new(-3660.07031, 26.1918774, -933.131897, -0.77232331, -7.22959044e-08, -0.635229647, -1.90984206e-08, 1, -9.05904614e-08, 0.635229647, -5.7833244e-08, -0.77232331),
    ["Isoteric Island"] = CFrame.new(2029.47913, 27.3972206, 1393.52319, 0.438848287, -3.30229497e-08, -0.89856118, 8.09404801e-08, 1, 2.55982613e-09, 0.89856118, -7.34489944e-08, 0.438848287),
    ["Crater Island"] = CFrame.new(973.268372, 7.36203814, 4879.09277, 0.99999994, -1.67766032e-08, -0.000279307278, 1.67553038e-08, 1, -7.62482344e-08, 0.000279307278, 7.62435519e-08, 0.99999994),
    ["Coral Reefs"] = CFrame.new(-3134.98511, 20.9564934, 2167.80566, 0.610140502, 5.54546098e-08, -0.792293251, -1.07331415e-08, 1, 6.17270004e-08, 0.792293251, -2.91583468e-08, 0.610140502),
    ["Kohana Volcano"] = CFrame.new(-525.122925, 24.0000591, 187.470749, 0.702778041, -1.4945584e-08, 0.711409211, 1.59372149e-09, 1, 1.18378477e-08, -0.711409211, -1.17821113e-08, 0.702778041),
    ["Fisherman Island"] = CFrame.new(33.5687256, 17.0335217, 2834.95557, 0.999833524, -8.21432367e-10, 0.0182459373, 2.40968401e-09, 1, 8.70248726e-08, -0.0182459373, 8.7054351e-08, 0.999833524),
    ["Esoteric Depths"] = CFrame.new(3152.74707, -1302.72986, 1438.05444, 0.442518562, -2.42594727e-08, -0.896759331, -8.6126515e-09, 1, 1.33023953e-08, 0.896759331, -2.15753335e-08, 0.442518562),
    ["Tropical Grove"] = CFrame.new(-2046.1554, 6.26801682, 3660.56006, -0.739083588, 1.74285066e-08, 0.673613727, -5.79817758e-08, 1, -8.94902854e-08, -0.673613727, -1.05198126e-07, -0.739083588),
    ["Treasure Room"] = CFrame.new(-3599.53491, -266.57373, -1566.98657),
    ["Weather Machine"] = CFrame.new(-1525.72632, 6.49999952, 1892.23645, 0.0615941137, 6.608282509e-10, -0.998101294, -6.8356556e-08, 1, 3.55628549e-09, 0.998101294, 6.84458072e-08, 0.0615941137),
    ["Sisyphus Statue"] = CFrame.new(-3692.22021, -135.574417, -1026.96167, -0.928567886, 9.83784361e-08, 0.371162564, 1.22746741e-07, 1, 4.20307664e-08, -0.371162564, 8.45874197e-08, -0.928567886)
}

-- Ambil semua nama Island
local islandNames = {}
for name, _ in pairs(islands) do
    table.insert(islandNames, name)
end
table.sort(islandNames, function(a, b) return a:lower() < b:lower() end)

-- Default Island
local selectedIsland = islandNames[1] or "Kohana"

-- Dropdown pilih Island
Tabs.Teleport:Dropdown({
    Title = "Select Island",
    Values = islandNames,
    Default = selectedIsland,
    Callback = function(value)
        selectedIsland = value
    end
})

-- Tombol Teleport Now
Tabs.Teleport:Button({
    Title = "Teleport Now",
    Callback = function()
        local player = game.Players.LocalPlayer
        local char = player.Character or player.CharacterAdded:Wait()
        local hrp = char:WaitForChild("HumanoidRootPart")

        local target = islands[selectedIsland]
        if target then
            char:PivotTo(target)
        end
    end
})

Tabs.Teleport:Section({ Title = "NPC" })

-- Daftar lokasi teleport (isi CFrame sesuai NPC)
local locations = {
    ["Jones"] = CFrame.new(-678.315857, 16.4103374, 595.322937, 0, 0, -1, 0, 1, 0, 1, 0, 0),
    ["McBoatson"] = CFrame.new(-627.383911, 3.04580736, 719.454956, 0, 0, -1, 0, 1, 0, 1, 0, 0),
    ["Tim"] = CFrame.new(-595.170044, 16.3734112, 608.429932, 0, 0, 1, 0, 1, -0, -1, 0, 0),
    ["Scientist"] = CFrame.new(-7.82026434, 14.6700287, 2885.70532, 0.862636983, 0.0440853015, -0.50389874, 8.76235612e-11, 0.99619472, 0.0871554911, 0.505823553, -0.0751835406, 0.859354377),
    ["Lava Fisherman"] = CFrame.new(-595.716797, 59.000061, 135.618927, 0.819155693, 0, 0.573571265, 0, 1, 0, -0.573571265, 0, 0.819155693)
}

-- Ambil semua nama NPC
local npcNames = {}
for name, _ in pairs(locations) do
    table.insert(npcNames, name)
end
table.sort(npcNames, function(a,b) return a:lower() < b:lower() end)

-- Pilihan default
local selectedLocation = npcNames[1] or "Jones"

-- Dropdown pilih NPC
Tabs.Teleport:Dropdown({
    Title = "Select NPC",
    Values = npcNames,
    Default = selectedLocation,
    Callback = function(value)
        selectedLocation = value
    end
})

-- Tombol Teleport Now
Tabs.Teleport:Button({
    Title = "Teleport Now",
    Callback = function()
        local player = game.Players.LocalPlayer
        local char = player.Character or player.CharacterAdded:Wait()
        local hrp = char:WaitForChild("HumanoidRootPart")

        local target = locations[selectedLocation]
        if target then
            char:PivotTo(target) -- teleport dengan cara aman
        end
    end
})

Tabs.Server:Section({ Title = "Fish" })

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")

local LocalPlayer = Players.LocalPlayer
local Notification = LocalPlayer:WaitForChild("PlayerGui"):WaitForChild("Small Notification")

-- Universal request (bypass HttpService block)
local Request = (syn and syn.request) or (http_request) or (fluxus and fluxus.request) or (krnl and request)

-- Variabel untuk simpan Webhook URL
local WebhookURL = ""
local WebhookActive = false

-- Variabel filter tier dari dropdown
local SelectedTiers = {}

-- Link Discord
local DiscordLink = "discord.gg/ECxQFc97F5"

-- Mapping Tier → Nama Rarity
local TierMap = {
    [1] = "Common",
    [2] = "Uncommon",
    [3] = "Rare",
    [4] = "Epic",
    [5] = "Legendary",
    [6] = "Mythic",
    [7] = "SECRET"
}

-- Fungsi format angka k/m/b
local function FormatNumber(num)
    num = tonumber(num) or 0
    if num >= 1e9 then
        return string.format("%.2fb", num / 1e9)
    elseif num >= 1e6 then
        return string.format("%.2fm", num / 1e6)
    elseif num >= 1e3 then
        return string.format("%.2fk", num / 1e3)
    else
        return tostring(num)
    end
end

-- Fungsi format chance ke persen
local function FormatChance(chance)
    chance = tonumber(chance) or 0
    return string.format("%.2f%%", chance * 100)
end

-- Fungsi kirim webhook embed + plain message
local function SendEmbed(data, plainMessage)
    if WebhookURL ~= "" and Request then
        local payload = {
            ["content"] = plainMessage or "Join Discord Nexa Hub discord.gg/ECxQFc97F5", -- message biasa di atas embed
            ["embeds"] = data.embeds
        }

        Request({
            Url = WebhookURL,
            Method = "POST",
            Headers = {["Content-Type"] = "application/json"},
            Body = HttpService:JSONEncode(payload)
        })
    end
end

-- Input Webhook URL
Tabs.Server:Input({
    Title = "Webhook URL",
    Value = "",
    Placeholder = "Url",
    Callback = function(input)
        WebhookURL = input
        print("Webhook set to: " .. WebhookURL)
    end
})

-- Toggle kirim pesan
Tabs.Server:Toggle({
    Title = "Enable Webhook",
    Value = false,
    Callback = function(state)
        WebhookActive = state
        if state then
            print("Webhook activated ✅")
            SendEmbed({
                ["embeds"] = {{
                    ["author"] = {["name"] = "Fishing System"},
                    ["title"] = "Webhook Aktif",
                    ["description"] = "✅ Webhook berhasil diaktifkan dan siap mengirim data.",
                    ["color"] = 5763719,
                    ["timestamp"] = DateTime.now():ToIsoDate()
                }}
            }, "Join our Discord: " .. DiscordLink)
        else
            print("Webhook deactivated ❌")
        end
    end
})

-- Dropdown filter tier
Tabs.Server:Dropdown({
    Title = "Select Tier to Send",
    Values = {"All", "Common", "Uncommon", "Rare", "Epic", "Legendary", "Mythic", "SECRET"},
    Value = {},
    Multi = true,
    AllowNone = true,
    Callback = function(option) 
        SelectedTiers = option
        print("Tier filter selected: " .. HttpService:JSONEncode(option))
    end
})

-- Fungsi cari module ikan (fuzzy match)
local function FindFishModule(fishName)
    local Items = ReplicatedStorage:WaitForChild("Items")
    for _, moduleScript in ipairs(Items:GetChildren()) do
        if moduleScript:IsA("ModuleScript") then
            local ok, data = pcall(require, moduleScript)
            if ok and data and data.Data and data.Data.Name then
                local realName = data.Data.Name
                if string.find(string.lower(fishName), string.lower(realName)) then
                    return data
                end
            end
        end
    end
    return nil
end

-- Detect ikan dari GUI
local Container = Notification.Display.Container
local ItemName = Container:WaitForChild("ItemName")
local NewLabel = Notification.Display.NewFrame.Frame:WaitForChild("NewLabel")

ItemName:GetPropertyChangedSignal("Text"):Connect(function()
    if WebhookActive and WebhookURL ~= "" and Request then
        local rawText = ItemName.Text
        if rawText ~= "" then
            -- Pisahkan nama ikan & berat
            local fishName, fishWeight = rawText:match("^(.-)%s*%((.-)%)$")
            fishName = (fishName and fishName:gsub("^%s+", ""):gsub("%s+$", "")) or rawText
            fishWeight = fishWeight or "Unknown"

            -- Cari data ikan
            local fishData = FindFishModule(fishName)

            local tierNum = fishData and fishData.Data.Tier or 0
            local tierName = TierMap[tierNum] or "Unknown"
            local sellPrice = fishData and fishData.SellPrice or "Unknown"
            local chance = fishData and fishData.Probability and fishData.Probability.Chance or 0

            local newLabelText = NewLabel.Text or ""

            -- Ambil Rarity GUI
            local RarityLabel = Container:WaitForChild("Rarity")
            local rarityText = RarityLabel.Text or "Unknown"

            -- Ambil BagSize dari Inventory
            local BagSizeLabel = Players.LocalPlayer.PlayerGui.Inventory.Main.Top.Options.Fish.Label:WaitForChild("BagSize")
            local bagSizeText = BagSizeLabel.Text or "Unknown"

            -- Cek filter tier
            if #SelectedTiers > 0 then
                if not table.find(SelectedTiers, "All") and not table.find(SelectedTiers, tierName) then
                    return -- skip kirim kalau tier tidak sesuai filter
                end
            end

            -- Buat embed
            local Data = {
                ["embeds"] = {{
                    ["author"] = {["name"] = "Nexa Fishing Info"},
                    ["title"] = "New Fish Caught!❗",
                    ["color"] = math.random(1000000, 16777215),
                    ["fields"] = {
                        {["name"] = "Fish 🐟", ["value"] = "```" .. fishName .. "```", ["inline"] = true},
                        {["name"] = "KG ⚖️", ["value"] = "```" .. fishWeight .. "```", ["inline"] = true},
                        {["name"] = "Tier 🥇", ["value"] = "```" .. tierName .. "```", ["inline"] = true},
                        {["name"] = "Rarity 🚀", ["value"] = "```" .. rarityText .. "```", ["inline"] = true},
                        {["name"] = "BagSize 💼", ["value"] = "```" .. bagSizeText .. "```", ["inline"] = true},
                        {["name"] = "SellPrice 💴", ["value"] = "```" .. FormatNumber(sellPrice) .. "```", ["inline"] = true},
                        {["name"] = "Chance 📈", ["value"] = "```" .. FormatChance(chance) .. "```", ["inline"] = true},
                    },
                    ["footer"] = {["text"] = "Nexa | Fishing Logger • Fish It! 🐟"},
                    ["timestamp"] = DateTime.now():ToIsoDate()
                }}
            }

            if newLabelText ~= "" then
                table.insert(Data.embeds[1].fields, {["name"] = "Info", ["value"] = "```" .. newLabelText .. "```", ["inline"] = false})
            end

            -- Kirim webhook + link Discord plain message
            SendEmbed(Data, "Join our Discord: " .. DiscordLink)
        end
    end
end)

Tabs.Server:Section({ Title = "Error Log" })

local HttpService = game:GetService("HttpService")
local ScriptContext = game:GetService("ScriptContext")
local LogService = game:GetService("LogService")

-- Variabel global
local webhookUrl = ""
local webhookEnabled = false

-- Input webhook URL
Tabs.Server:Input({
    Title = "Webhook Url",
    Value = "",
    Placeholder = "Url",
    Callback = function(input) 
        webhookUrl = input
        print("Webhook URL set:", webhookUrl)
    end
})

-- Toggle webhook
Tabs.Server:Toggle({
    Title = "Enable Webhook",
    Value = false,
    Callback = function(state) 
        webhookEnabled = state
        print("Webhook enabled:", webhookEnabled)
    end
})

-- Helper buat gabung message dengan aman
local function toMessage(...)
    local parts = {}
    for _, v in ipairs({...}) do
        table.insert(parts, tostring(v))
    end
    return table.concat(parts, " ")
end

-- Fungsi kirim ke webhook (bypass executor block)
local function sendToWebhook(msg)
    if webhookEnabled and webhookUrl ~= "" then
        local data = {
            ["content"] = "**[Console Log]**\n```lua\n".. msg .. "\n```"
        }

        local body = HttpService:JSONEncode(data)

        -- pilih request function sesuai executor
        local request = syn and syn.request or http_request or request or (http and http.request)

        if request then
            pcall(function()
                request({
                    Url = webhookUrl,
                    Method = "POST",
                    Headers = {
                        ["Content-Type"] = "application/json"
                    },
                    Body = body
                })
            end)
        else
            -- fallback ke PostAsync kalau executor nggak punya request
            pcall(function()
                HttpService:PostAsync(webhookUrl, body)
            end)
        end
    end
end

-- Tangkap semua error
ScriptContext.Error:Connect(function(message, stackTrace)
    sendToWebhook("[Error] " .. message .. "\n" .. stackTrace)
end)

-- Tangkap semua log dari console (print, warn, error)
LogService.MessageOut:Connect(function(message, messageType)
    local prefix = "[Info]"
    if messageType == Enum.MessageType.MessageWarning then
        prefix = "[Warning]"
    elseif messageType == Enum.MessageType.MessageError then
        prefix = "[Error]"
    end
    sendToWebhook(prefix .. " " .. message)
end)

-- Optional: override print/warn/error untuk executor tertentu
local oldPrint = print
print = function(...)
    oldPrint(...)
    sendToWebhook("[Print] " .. toMessage(...))
end

local oldWarn = warn
warn = function(...)
    oldWarn(...)
    sendToWebhook("[Warn] " .. toMessage(...))
end

local oldError = error
error = function(...)
    oldError(...)
    sendToWebhook("[ErrorFunc] " .. toMessage(...))
end

Tabs.Server:Section({ Title = "Staff" })

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- 🔒 List of Staff UserIds
local staffIds = {
    75974130,
    33372493,
    30944240,
}

-- 🌐 Global Flags
getgenv().StaffDetectionEnabled = false
getgenv().StaffActions = { "Notify" } -- default: Notify

-- ✅ Check if player is staff
local function isStaff(player)
    for _, id in ipairs(staffIds) do
        if player.UserId == id then
            return true
        end
    end
    return false
end

-- ⚠️ Handle detected staff
local function handleStaff(player)
    if not getgenv().StaffDetectionEnabled then return end
    if not isStaff(player) then return end

    for _, action in ipairs(getgenv().StaffActions) do
        if action == "Kick" then
            LocalPlayer:Kick("Staff detected: " .. player.Name)
        elseif action == "Notify" then
            UI:Notify({
                Title = "⚠️ Staff Detected",
                Content = player.Name .. " (UserId: " .. player.UserId .. ") joined!",
                Duration = 6.5
            })
        end
    end
end

-- 🔁 Detect staff on join
Players.PlayerAdded:Connect(function(player)
    handleStaff(player)
end)

-- 🔘 Main Toggle
Tabs.Server:Toggle({
    Title = "Anti Staff",
    Value = true,
    Callback = function(state)
        getgenv().StaffDetectionEnabled = state
        print("Anti Staff Enabled: " .. tostring(state))

        -- Scan current players if enabled
        if state then
            for _, player in ipairs(Players:GetPlayers()) do
                handleStaff(player)
            end
        end
    end
})

-- 🔽 Multi-Select Dropdown for Actions
Tabs.Server:Dropdown({
    Title = "Staff Actions",
    Desc = "Choose actions to execute when staff is detected",
    Values = { "Kick", "Notify" },
    Value = { "Notify" },
    Multi = true,
    AllowNone = false,
    Callback = function(option)
        getgenv().StaffActions = option
        print("Selected staff actions: " .. game:GetService("HttpService"):JSONEncode(option))
    end
})

local Players = game:GetService("Players")
local VirtualUser = game:GetService("VirtualUser")

local antiAFKConnection = nil

-- Function to enable or disable Anti-AFK
local function setAntiAFK(state)
    if state then
        if not antiAFKConnection then
            antiAFKConnection = Players.LocalPlayer.Idled:Connect(function()
                VirtualUser:Button2Down(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
                task.wait(1)
                VirtualUser:Button2Up(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
                print("✅ Anti-AFK triggered")
            end)
        end
    else
        if antiAFKConnection then
            antiAFKConnection:Disconnect()
            antiAFKConnection = nil
            print("❌ Anti-AFK disabled")
        end
    end
end

-- WindUI Toggle
Tabs.Server:Toggle({
    Title = "Anti AFK",
    Value = true,
    Callback = setAntiAFK
})



Tabs.Server:Section({ Title = "Server" })

Tabs.Server:Divider()

-- 📦 Services
local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")

-- 👤 Pemain lokal
local LocalPlayer = Players.LocalPlayer

-- 🔘 Tombol WindUI untuk Rejoin
Tabs.Server:Button({
    Title = "Rejoin Server",
    Callback = function()
        local placeId = game.PlaceId
        local jobId = game.JobId
        TeleportService:TeleportToPlaceInstance(placeId, jobId, LocalPlayer)
    end
})

-- 📦 Roblox Services
local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")

local LocalPlayer = Players.LocalPlayer

-- 🌐 Server Hop dengan WindUI
Tabs.Server:Button({
    Title = "Server Hop",
    Callback = function()
        local success, response = pcall(function()
            local url = ("https://games.roblox.com/v1/games/%d/servers/Public?sortOrder=Asc&limit=100"):format(game.PlaceId)
            return game:HttpGet(url)
        end)

        if not success then
            warn("Gagal ambil data server.")
            return
        end

        local servers = HttpService:JSONDecode(response)
        for _, server in ipairs(servers.data) do
            if server.playing < server.maxPlayers and server.id ~= game.JobId then
                TeleportService:TeleportToPlaceInstance(game.PlaceId, server.id, LocalPlayer)
                return
            end
        end

        warn("Tidak ada server lain yang tersedia.")
    end
})

Tabs.Server:Button({
    Title = "Copy Job ID",
    Desc = "Copy the server JobId to the clipboard",
    Callback = function()
        setclipboard(game.JobId)
    end
})

local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local PlaceId = game.PlaceId

local targetJobId = ""

Tabs.Server:Input({
    Title = "Enter Job ID",
    PlaceholderText = "Enter the JobId here...",
    Default = "",
    Callback = function(text)
        targetJobId = text
    end
})

Tabs.Server:Button({
    Title = "Teleport to Job ID",
    Desc = "Teleport to the server using the provided JobId",
    Callback = function()
        if targetJobId ~= "" then
            TeleportService:TeleportToPlaceInstance(PlaceId, targetJobId, LocalPlayer)
        end
    end
})

Tabs.Visual:Section({ Title = "Visual" })

-- Tombol Shop UI: Rod
local shopUIPrompt = workspace["!!! MENU RINGS"].Ring.ProximityPrompt
Tabs.Visual:Button({
    Title = "Shop UI: Rod",
    Callback = function()
        fireproximityprompt(shopUIPrompt)
    end
})

local shopUIPrompt = workspace["!!! MENU RINGS"]["Enchanted Crate"].Prompt.MenuPromptAttachment.ProximityPrompt
Tabs.Visual:Button({
    Title = "Shop UI: Skin Crates",
    Callback = function()
        fireproximityprompt(shopUIPrompt)
    end
})

-- Simpan setting lighting & particle untuk dikembalikan saat toggle mati
local originalLightingSettings = {
    GlobalShadows = game.Lighting.GlobalShadows,
    Brightness = game.Lighting.Brightness,
    FogEnd = game.Lighting.FogEnd,
    ClockTime = game.Lighting.ClockTime
}

local originalParticles = {}
for _, v in pairs(workspace:GetDescendants()) do
    if v:IsA("ParticleEmitter") or v:IsA("Trail") or v:IsA("Smoke") then
        originalParticles[v] = v.Enabled
    end
end

-- WindUI Toggle
Tabs.Visual:Toggle({ 
    Title = "Black Screen",
    Value = false,
    Callback = function(state)
        local player = game.Players.LocalPlayer
        local playerGui = player:WaitForChild("PlayerGui")
        
        -- Cari ScreenGui DarkScreenGUI
        local darkGui = playerGui:FindFirstChild("DarkScreenGUI")
        
        if state then
            -- Aktifkan Dark Screen
            if not darkGui then
                darkGui = Instance.new("ScreenGui")
                darkGui.Name = "DarkScreenGUI"
                darkGui.ResetOnSpawn = false
                darkGui.IgnoreGuiInset = true
                darkGui.Parent = playerGui

                local darkFrame = Instance.new("Frame")
                darkFrame.Name = "DarkFrame"
                darkFrame.Size = UDim2.new(1, 0, 1, 0)
                darkFrame.Position = UDim2.new(0, 0, 0, 0)
                darkFrame.BackgroundColor3 = Color3.new(0, 0, 0)
                darkFrame.BackgroundTransparency = 0
                darkFrame.BorderSizePixel = 0
                darkFrame.Parent = darkGui
            end

            -- Matikan efek lighting & particle untuk hemat GPU/CPU
            local lighting = game:GetService("Lighting")
            lighting.GlobalShadows = false
            lighting.Brightness = 0
            lighting.FogEnd = 100000
            lighting.ClockTime = 12

            for particle, _ in pairs(originalParticles) do
                particle.Enabled = false
            end

        else
            -- Matikan Dark Screen
            if darkGui then
                darkGui:Destroy()
            end

            -- Kembalikan setting lighting
            local lighting = game:GetService("Lighting")
            lighting.GlobalShadows = originalLightingSettings.GlobalShadows
            lighting.Brightness = originalLightingSettings.Brightness
            lighting.FogEnd = originalLightingSettings.FogEnd
            lighting.ClockTime = originalLightingSettings.ClockTime

            -- Kembalikan particle
            for particle, enabled in pairs(originalParticles) do
                if particle.Parent then
                    particle.Enabled = enabled
                end
            end
        end

    end
})

Tabs.Visual:Button({ 
    Title = "Boost FPS",  -- Nama tombol
    Callback = function() 
        WindUI:Notify({
            Title = "Boost FPS",
            Content = "On!",
            Duration = 5,
        })

        -- Script Boost FPS
        local Lighting = game:GetService("Lighting")
        local Workspace = game:GetService("Workspace")
        local Players = game:GetService("Players")
        local LocalPlayer = Players.LocalPlayer

        -- Optimasi grafis
        Lighting.GlobalShadows = false
        Lighting.FogEnd = 9e9
        Lighting.Brightness = 1
        Lighting.ExposureCompensation = 0
        Lighting.OutdoorAmbient = Color3.fromRGB(128,128,128)
        Lighting.ShadowSoftness = 0

        pcall(function()
            for _, obj in pairs(Workspace:GetDescendants()) do
                if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Explosion") then
                    obj.Enabled = false
                elseif obj:IsA("Decal") or obj:IsA("Texture") then
                    obj.Transparency = 1
                end
            end
        end)
    end
})

Tabs.Visual:Button({
    Title = "Reduce Lag", -- Nama tombol
    Callback = function()
        -- Notifikasi
        WindUI:Notify({
            Title = "Reduce Lag",
            Content = "On!",
            Duration = 5,
        })

        -- Script Reduce Lag
        local Players = game:GetService("Players")
        local Workspace = game:GetService("Workspace")
        local Lighting = game:GetService("Lighting")
        local LocalPlayer = Players.LocalPlayer

        -- Optimasi Lighting
        Lighting.GlobalShadows = false
        Lighting.FogEnd = 9e9
        Lighting.Brightness = 1
        Lighting.OutdoorAmbient = Color3.fromRGB(128,128,128)
        Lighting.ExposureCompensation = 0
        Lighting.ShadowSoftness = 0

        -- Hapus efek particle dan decal
        for _, obj in pairs(Workspace:GetDescendants()) do
            if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Explosion") then
                obj.Enabled = false
            elseif obj:IsA("Decal") or obj:IsA("Texture") then
                obj.Transparency = 1
            end
        end

        -- Optimasi GUI player
        for _, gui in pairs(LocalPlayer:WaitForChild("PlayerGui"):GetDescendants()) do
            if gui:IsA("TextLabel") or gui:IsA("TextButton") then
                gui.TextScaled = false
            elseif gui:IsA("ImageLabel") or gui:IsA("ImageButton") then
                gui.ImageTransparency = 0.5
            end
        end

    end
})

-- WindUI Toggle: Disable Backpack
Tabs.Visual:Toggle({
    Title = "Disable Backpack",
    Value = false,
    Callback = function(state)
        local Players = game:GetService("Players")
        local LocalPlayer = Players.LocalPlayer

        if LocalPlayer:FindFirstChild("PlayerGui") then
            local BackpackGui = LocalPlayer.PlayerGui:FindFirstChild("Backpack")
            if BackpackGui then
                BackpackGui.Enabled = not state and true or false
            end
        end
    end
})

-----------------------------------------------------
-- BAGIAN IMAGEBUTTON DI LAYAR
-----------------------------------------------------
local TweenService = game:GetService("TweenService")

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = game.CoreGui

local ImgBtn = Instance.new("ImageButton")
ImgBtn.Parent = ScreenGui
ImgBtn.Size = UDim2.new(0, 60, 0, 60)
ImgBtn.Position = UDim2.new( 0, 100, 1, -300)
ImgBtn.BackgroundTransparency = 1
ImgBtn.Image = "rbxassetid://137184014634632" -- ganti dengan gambar planet

-- Biar ujung tombol bulat/halus
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 15)
UICorner.Parent = ImgBtn

-- Toggle GUI dengan ImageButton
local isOpen = false
ImgBtn.MouseButton1Click:Connect(function()
    -- ANIMASI KLIK (scale kecil dulu baru balik normal)
    local shrink = TweenService:Create(ImgBtn, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
        Size = UDim2.new(0, 50, 0, 50)
    })
    local grow = TweenService:Create(ImgBtn, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
        Size = UDim2.new(0, 60, 0, 60)
    })

    shrink:Play()
    shrink.Completed:Wait()
    grow:Play()

    -- Toggle Window
    if isOpen then
        Window:Close()
    else
        Window:Open()
    end
    isOpen = not isOpen
end)

-----------------------------------------------------
-- SISTEM DRAG IMAGEBUTTON (PC & HP SUPPORT)
-----------------------------------------------------
local UserInputService = game:GetService("UserInputService")
local dragging = false
local dragInput, dragStart, startPos

local function update(input)
    local delta = input.Position - dragStart
    ImgBtn.Position = UDim2.new(
        startPos.X.Scale, startPos.X.Offset + delta.X,
        startPos.Y.Scale, startPos.Y.Offset + delta.Y
    )
end

ImgBtn.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 
    or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = ImgBtn.Position

        -- biar bisa lepas drag kalau jari/mouse diangkat
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

ImgBtn.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement 
    or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)
